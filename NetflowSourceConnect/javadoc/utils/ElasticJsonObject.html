<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_251) on Sat Nov 06 12:51:44 EET 2021 -->
<title>ElasticJsonObject</title>
<meta name="date" content="2021-11-06">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="ElasticJsonObject";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":10,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10,"i10":10,"i11":10,"i12":10,"i13":10,"i14":10,"i15":10,"i16":9,"i17":10,"i18":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ElasticJsonObject.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../utils/CsvRecordSchema.html" title="class in utils"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../utils/Helpers.html" title="class in utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?utils/ElasticJsonObject.html" target="_top">Frames</a></li>
<li><a href="ElasticJsonObject.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">utils</div>
<h2 title="Class ElasticJsonObject" class="title">Class ElasticJsonObject</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>utils.ElasticJsonObject</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">ElasticJsonObject</span>
extends java.lang.Object</pre>
<div class="block">ElasticJsonObject class. Converts a Map object, which contains all info for a
 csv record (column name, column value) into a JSON object, which follows the
 proper schema in order to be ingested to Elastic. The mapping between the input
 object and the output JSON object is happening using a .json file. This file contains
 the category name and category sub-name, which each csv column is mapped to in order
 for the Elastic JSON object to be created. This class, also contains some helper
 function to convert the input record.</div>
<dl>
<dt><span class="simpleTagLabel">Since:</span></dt>
<dd>0.1-SNAPSHOT</dd>
<dt><span class="simpleTagLabel">Version:</span></dt>
<dd>0.1-SNAPSHOT</dd>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>Space Hellas S.A.</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#agentJson">agentJson</a></span></code>
<div class="block">A JSON object, which stores information about the process that ingest data to Elastic.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#containerized">containerized</a></span></code>
<div class="block">A boolean value, showing if this host is running inside a container or not.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#hostArch">hostArch</a></span></code>
<div class="block">OS architecture of this host.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#hostId">hostId</a></span></code>
<div class="block">Host ID of the computer that converts the csv records to Elastic JSON objects.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#hostIp">hostIp</a></span></code>
<div class="block">IP address of this host.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#hostMac">hostMac</a></span></code>
<div class="block">MAC address of this host.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#hostname">hostname</a></span></code>
<div class="block">Hostname of the computer that converts the csv records to Elastic JSON objects</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private <a href="../utils/IanaProtocolNumbers.html" title="class in utils">IanaProtocolNumbers</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#ianaProtocolNumbers">ianaProtocolNumbers</a></span></code>
<div class="block">An object, which maps network protocols' names into IANA numbers.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private java.util.ArrayList&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#internalIps">internalIps</a></span></code>
<div class="block">An Arraylist, that contains which IPs will be labeled as internals and externals.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private static org.apache.log4j.Logger</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#logger">logger</a></span></code>
<div class="block">Logger Instance.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#mappingJson">mappingJson</a></span></code>
<div class="block">A JSON object, which will store all the information about the mapping between the
 csv record and the generated Elastic JSON object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private com.rapid7.communityid.CommunityIdGenerator</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#networkCommunityIdGenerator">networkCommunityIdGenerator</a></span></code>
<div class="block">A generator, which generates a community ID of each flow, based on its properties.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>private org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#osInfoJson">osInfoJson</a></span></code>
<div class="block">A JSON object containing information about the OS of this host.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>private boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#rawNetflowMappingFile">rawNetflowMappingFile</a></span></code>
<div class="block">Boolean If the .json mapping file for raw netflows will be loaded.</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#ElasticJsonObject-boolean-">ElasticJsonObject</a></span>(boolean&nbsp;raw)</code>
<div class="block">Constructor</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#checkIpLocality-java.lang.String-">checkIpLocality</a></span>(java.lang.String&nbsp;ipAddr)</code>
<div class="block">Checks if a given IP address is internal or external.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#convertTimestamp-java.lang.String-">convertTimestamp</a></span>(java.lang.String&nbsp;timestamp)</code>
<div class="block">Converts a given timestamp in format "YYYY-MM-DD hh:mm:ss.SSS" to format "YYYY-MM-DDThh:mm:ss.SSSZ".</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code>org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#createRecord-java.util.HashMap-">createRecord</a></span>(java.util.HashMap&lt;java.lang.String,java.lang.Object&gt;&nbsp;csvMap)</code>
<div class="block">Converts a Map that contains column names and values from a csv record into a JSON
 object with the correct schema in order to be inserted in Elastic.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>private int</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#encodeTcpFlags-java.lang.String-">encodeTcpFlags</a></span>(java.lang.String&nbsp;flags)</code>
<div class="block">Encode TCP flags to an integer number, which is created for the sum of each
 flag's representation as an integer number.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#generateFlowId--">generateFlowId</a></span>()</code>
<div class="block">Generates an ID for the netflow.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getHostArch--">getHostArch</a></span>()</code>
<div class="block">Returns host's OS architecture.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getHostname--">getHostname</a></span>()</code>
<div class="block">Retrieves hostname.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getIpAddress--">getIpAddress</a></span>()</code>
<div class="block">Retrieves the IP address of the host.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getJsonSubKey-java.lang.String-java.lang.String-">getJsonSubKey</a></span>(java.lang.String&nbsp;key,
             java.lang.String&nbsp;subkey)</code>
<div class="block">Return a sub-category key from .json file, which is used for mapping the csv input record
 with the Elastic output json one.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getMacAddress--">getMacAddress</a></span>()</code>
<div class="block">Retrieves the MAC address of the host.</div>
</td>
</tr>
<tr id="i10" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getNetflowDirection-java.lang.String-java.lang.String-">getNetflowDirection</a></span>(java.lang.String&nbsp;srcIp,
                   java.lang.String&nbsp;dstIp)</code>
<div class="block">Checks if the given netflow is internal, external, inbound or outbound.</div>
</td>
</tr>
<tr id="i11" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getNetworkCommunityId-java.lang.String-java.lang.String-int-int-java.lang.String-">getNetworkCommunityId</a></span>(java.lang.String&nbsp;srcIp,
                     java.lang.String&nbsp;dstIp,
                     int&nbsp;srcPort,
                     int&nbsp;dstPort,
                     java.lang.String&nbsp;protocol)</code>
<div class="block">Creates and returns the network community ID of the netflow.</div>
</td>
</tr>
<tr id="i12" class="altColor">
<td class="colFirst"><code>private org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getOsInfo--">getOsInfo</a></span>()</code>
<div class="block">Retrieves information from System, about the OS.</div>
</td>
</tr>
<tr id="i13" class="rowColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#getRandomUuid--">getRandomUuid</a></span>()</code>
<div class="block">Generates a random UUID.</div>
</td>
</tr>
<tr id="i14" class="altColor">
<td class="colFirst"><code>private java.lang.String</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#hashHostname--">hashHostname</a></span>()</code>
<div class="block">Hashes the hostname using SHA-1 algorithm and returns the hashed value.</div>
</td>
</tr>
<tr id="i15" class="rowColor">
<td class="colFirst"><code>private org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#initializeAgentJson--">initializeAgentJson</a></span>()</code>
<div class="block">Retrieves some information about the agent, making the conversion.</div>
</td>
</tr>
<tr id="i16" class="altColor">
<td class="colFirst"><code>static java.lang.Boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#isContainerized--">isContainerized</a></span>()</code>
<div class="block">Checks if the connector is running inside a container or not.</div>
</td>
</tr>
<tr id="i17" class="rowColor">
<td class="colFirst"><code>private java.util.ArrayList&lt;java.lang.String&gt;</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#loadInternalSubnets--">loadInternalSubnets</a></span>()</code>
<div class="block">Loads all subnets, that their IPs must be defined as internal IPs.</div>
</td>
</tr>
<tr id="i18" class="altColor">
<td class="colFirst"><code>private org.json.JSONObject</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../utils/ElasticJsonObject.html#loadMappingFile-boolean-">loadMappingFile</a></span>(boolean&nbsp;raw)</code>
<div class="block">Loads a JSON file, that contains some mapping details between the csv column
 name and the category and sub-category of the new Elastic JSON object.</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>clone, equals, finalize, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field.detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="logger">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>logger</h4>
<pre>private static&nbsp;org.apache.log4j.Logger logger</pre>
<div class="block">Logger Instance.</div>
</li>
</ul>
<a name="rawNetflowMappingFile">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>rawNetflowMappingFile</h4>
<pre>private&nbsp;boolean rawNetflowMappingFile</pre>
<div class="block">Boolean If the .json mapping file for raw netflows will be loaded. (Default: False)</div>
</li>
</ul>
<a name="mappingJson">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>mappingJson</h4>
<pre>private&nbsp;org.json.JSONObject mappingJson</pre>
<div class="block">A JSON object, which will store all the information about the mapping between the
 csv record and the generated Elastic JSON object.</div>
</li>
</ul>
<a name="internalIps">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>internalIps</h4>
<pre>private&nbsp;java.util.ArrayList&lt;java.lang.String&gt; internalIps</pre>
<div class="block">An Arraylist, that contains which IPs will be labeled as internals and externals.</div>
</li>
</ul>
<a name="hostname">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hostname</h4>
<pre>private&nbsp;java.lang.String hostname</pre>
<div class="block">Hostname of the computer that converts the csv records to Elastic JSON objects</div>
</li>
</ul>
<a name="hostId">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hostId</h4>
<pre>private&nbsp;java.lang.String hostId</pre>
<div class="block">Host ID of the computer that converts the csv records to Elastic JSON objects.
 This ID is produced by hashing the hostname.</div>
</li>
</ul>
<a name="osInfoJson">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>osInfoJson</h4>
<pre>private&nbsp;org.json.JSONObject osInfoJson</pre>
<div class="block">A JSON object containing information about the OS of this host.</div>
</li>
</ul>
<a name="containerized">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>containerized</h4>
<pre>private&nbsp;boolean containerized</pre>
<div class="block">A boolean value, showing if this host is running inside a container or not.</div>
</li>
</ul>
<a name="hostIp">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hostIp</h4>
<pre>private&nbsp;java.lang.String hostIp</pre>
<div class="block">IP address of this host.</div>
</li>
</ul>
<a name="hostMac">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hostMac</h4>
<pre>private&nbsp;java.lang.String hostMac</pre>
<div class="block">MAC address of this host.</div>
</li>
</ul>
<a name="hostArch">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hostArch</h4>
<pre>private&nbsp;java.lang.String hostArch</pre>
<div class="block">OS architecture of this host.</div>
</li>
</ul>
<a name="agentJson">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>agentJson</h4>
<pre>private&nbsp;org.json.JSONObject agentJson</pre>
<div class="block">A JSON object, which stores information about the process that ingest data to Elastic.</div>
</li>
</ul>
<a name="ianaProtocolNumbers">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>ianaProtocolNumbers</h4>
<pre>private&nbsp;<a href="../utils/IanaProtocolNumbers.html" title="class in utils">IanaProtocolNumbers</a> ianaProtocolNumbers</pre>
<div class="block">An object, which maps network protocols' names into IANA numbers.</div>
</li>
</ul>
<a name="networkCommunityIdGenerator">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>networkCommunityIdGenerator</h4>
<pre>private&nbsp;com.rapid7.communityid.CommunityIdGenerator networkCommunityIdGenerator</pre>
<div class="block">A generator, which generates a community ID of each flow, based on its properties.</div>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor.detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="ElasticJsonObject-boolean-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>ElasticJsonObject</h4>
<pre>public&nbsp;ElasticJsonObject(boolean&nbsp;raw)</pre>
<div class="block">Constructor</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>raw</code> - Boolean If this object is responsible to convert and ingest raw netflow data or not.
            If this is set to false, then this object is responsible to convert and ingest
            preprocessed netflow records.</dd>
</dl>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="isContainerized--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isContainerized</h4>
<pre>public static&nbsp;java.lang.Boolean&nbsp;isContainerized()</pre>
<div class="block">Checks if the connector is running inside a container or not. The check is happening reading the file
 /proc/1/cgroup and searching for a line that contains the value /docker. If this value is not found, or
 any error occurs, it is considered that the connector is not running inside a container.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>Boolean True if the app runs in container, False otherwise.</dd>
</dl>
</li>
</ul>
<a name="createRecord-java.util.HashMap-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createRecord</h4>
<pre>public&nbsp;org.json.JSONObject&nbsp;createRecord(java.util.HashMap&lt;java.lang.String,java.lang.Object&gt;&nbsp;csvMap)</pre>
<div class="block">Converts a Map that contains column names and values from a csv record into a JSON
 object with the correct schema in order to be inserted in Elastic. The mapping between
 the fields of the objects is happening using a .json file, which contains for each catefory
 and sub-category of the produced Elastic JSON, which csv column is corresponding.
 <p>
 The structure of the produces JSON is the same with the output of Filebeat netflow module (v7.13.3)
 https://www.elastic.co/guide/en/beats/filebeat/7.13/filebeat-module-netflow.html
 <p>
 The schema of the converted Elastic JSON is the following:
 The values are from an example. Strings in parenthesis ([]) in the right of each values,
 shows its type.<br>
 <br>
 {<br>
 "@timestamp": "2021-09-21T10:05:27.772Z",<br>
 "@metadata": {<br>
 "beat": "filebeat", [String]<br>
 "type": "_doc", [String]<br>
 "version": "7.13.3" [String]<br>
 },<br>
 "flow": {<br>
 "id": "xq-DxFb9aRg", [String]<br>
 "locality": "external" [String]<br>
 },<br>
 "source": {<br>
 "ip": "127.16.226.121", [String]<br>
 "locality": "internal", [String]<br>
 "port": 12053, [Integer]<br>
 "bytes": 701, [Integer]<br>
 "packets": 714 [Integer]<br>
 },<br>
 "related": {<br>
 "ip": [<br>
 "127.16.226.121", [String]<br>
 "1.73.223.141" [String]<br>
 ]<br>
 },<br>
 "netflow": {<br>
 "destination_ipv4_prefix_length": 2, [Integer]<br>
 "destination_transport_port": 39593, [Integer]<br>
 "source_ipv4_address": "127.16.226.121", [String]<br>
 "type": "netflow_flow", [String]<br>
 "destination_ipv4_address": "1.73.223.141", [String]<br>
 "flow_start_sys_up_time": 180008, [Long]<br>
 "octet_delta_count": 701, [Integer]<br>
 "ingress_interface": 0, [Integer]<br>
 "exporter": {<br>
 "timestamp": "2021-09-21T10:05:27.772Z", [String]<br>
 "uptime_millis": 180273, [Long]<br>
 "address": "10.1.1.10:45422", [String]<br>
 "engine_type": 1, [Integer]<br>
 "engine_id": 0, [Integer]<br>
 "sampling_interval": 0, [Integer]<br>
 "version": 5 [Integer]<br>
 },<br>
 "bgp_destination_as_number": 63874, [Integer]<br>
 "bgp_source_as_number": 55849, [Integer]<br>
 "egress_interface": 0, [Integer]<br>
 "source_ipv4_prefix_length": 29, [Integer]<br>
 "source_transport_port": 12053, [Integer]<br>
 "ip_next_hop_ipv4_address": "144.63.0.157", [String]<br>
 "tcp_control_bits": 0, [Integer]<br>
 "protocol_identifier": 6, [Integer]<br>
 "ip_class_of_service": 0, [Integer]<br>
 "flow_end_sys_up_time": 180019, [Long]<br>
 "packet_delta_count": 714 [Integer]<br>
 },<br>
 "input": {<br>
 "type": "netflow" [String]<br>
 },<br>
 "host": {<br>
 "os": {<br>
 "family": "debian",<br>
 "name": "Ubuntu",<br>
 "kernel": "5.10.16.3-microsoft-standard-WSL2",<br>
 "codename": "focal",<br>
 "type": "linux",<br>
 "platform": "ubuntu",<br>
 "version": "20.04.3 LTS (Focal Fossa)"<br>
 },<br>
 "id": "fd6967b5ad4443c49d1b95591615ac0f", [String]<br>
 "containerized": true, [Boolean]<br>
 "ip": [<br>
 "10.1.1.100" [String]<br>
 ],<br>
 "mac": [<br>
 "02:42:0a:01:01:64" [String]<br>
 ],<br>
 "hostname": "4ed956acb491", [String]<br>
 "architecture": "x86_64", [String]<br>
 "name": "4ed956acb491" [String]<br>
 },<br>
 "event": {<br>
 "action": "netflow_flow", [String]<br>
 "type": [<br>
 "connection" [String]<br>
 ],<br>
 "start": "2021-09-21T10:05:27.507Z", [String]<br>
 "end": "2021-09-21T10:05:27.518Z", [String]<br>
 "duration": 11000000.0, [Double]<br>
 "created": "2021-09-21T10:05:27.773Z", [String]<br>
 "kind": "event", [String]<br>
 "category": [<br>
 "network_traffic", [String]<br>
 "network" [String]<br>
 ]<br>
 },<br>
 "observer": {<br>
 "ip": "10.1.1.10" [String]<br>
 },<br>
 "agent": {<br>
 "ephemeral_id": "16687a5b-e274-412f-9ca2-be902aa329fb", [String]<br>
 "id": "a63ed50b-3dee-4858-bf2c-560f10495a8e", [String]<br>
 "name": "4ed956acb491", [String]<br>
 "type": "kafka-connect", [String]<br>
 "version": "2.8.0", [String]<br>
 "hostname": "4ed956acb491" [String]<br>
 },<br>
 "ecs": {<br>
 "version": "1.8.0" [String]<br>
 },<br>
 "destination": {<br>
 "locality": "external", [String]<br>
 "port": 39593, [Integer]<br>
 "ip": "1.73.223.141" [String]<br>
 },<br>
 "network": {<br>
 "iana_number": 6, [Integer]<br>
 "bytes": 701, [Integer]<br>
 "packets": 714, [Integer]<br>
 "direction": "unknown",<br>
 "community_id": "1:tniq9qzbhk46AsUdXWbgwX6G48k=", [String]<br>
 "transport": "tcp" [String]<br>
 }<br>
 }<br>
 <br></div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>csvMap</code> - HashMap(String, Object) A map, which contains all columns and their
               values form a csv record</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>JSONObject A JSON object with the appropriate schema, in order to be
 ingested in Elastic.</dd>
</dl>
</li>
</ul>
<a name="getJsonSubKey-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getJsonSubKey</h4>
<pre>private&nbsp;java.lang.String&nbsp;getJsonSubKey(java.lang.String&nbsp;key,
                                       java.lang.String&nbsp;subkey)</pre>
<div class="block">Return a sub-category key from .json file, which is used for mapping the csv input record
 with the Elastic output json one. The result is the csv column name, which will be used.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>key</code> - String The mapping category name.</dd>
<dd><code>subkey</code> - String The mapping sub-category name.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The name of the csv column to use in order to extract this information.</dd>
</dl>
</li>
</ul>
<a name="convertTimestamp-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>convertTimestamp</h4>
<pre>private&nbsp;java.lang.String&nbsp;convertTimestamp(java.lang.String&nbsp;timestamp)</pre>
<div class="block">Converts a given timestamp in format "YYYY-MM-DD hh:mm:ss.SSS" to format "YYYY-MM-DDThh:mm:ss.SSSZ".
 i.e. The timestamp 2021-10-27 10:29:05.123 will be converted and return as 2021-10-27T10:29:05.123Z</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>timestamp</code> - Timestamp to be converted in format "YYYY-MM-DD hh:mm:ss.SSS".</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String Timestamp in format "YYYY-MM-DDThh:mm:ss.SSSZ".</dd>
</dl>
</li>
</ul>
<a name="checkIpLocality-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>checkIpLocality</h4>
<pre>private&nbsp;java.lang.String&nbsp;checkIpLocality(java.lang.String&nbsp;ipAddr)</pre>
<div class="block">Checks if a given IP address is internal or external. The checking is taking place using a file
 with all internal IP addresses. If the given IP is found in this list, then it is considered as
 internal IP. Otherwise, it is considered as external IP address.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>ipAddr</code> - String The IP address to check if it is internal or not.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String Returns "internal" if the given IP is found in list with internal IP addresses
 and "external" otherwise.</dd>
</dl>
</li>
</ul>
<a name="getRandomUuid--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getRandomUuid</h4>
<pre>private&nbsp;java.lang.String&nbsp;getRandomUuid()</pre>
<div class="block">Generates a random UUID.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The generated UUID.</dd>
</dl>
</li>
</ul>
<a name="generateFlowId--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>generateFlowId</h4>
<pre>private&nbsp;java.lang.String&nbsp;generateFlowId()</pre>
<div class="block">Generates an ID for the netflow. The generated ID is a random UUID.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The generated Flow ID.</dd>
</dl>
</li>
</ul>
<a name="getOsInfo--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getOsInfo</h4>
<pre>private&nbsp;org.json.JSONObject&nbsp;getOsInfo()</pre>
<div class="block">Retrieves information from System, about the OS. The following properties are retrieved:
 OS family, OS name, OS codename, OS platform, OS version, OS type and OS kernel. If any of these
 properties cannot be found, its value is set to "Unknown". All retrieved properties are saved
 in a JSON object.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>JSONObject A json object that contains all the retrieved information about the host's OS.</dd>
</dl>
</li>
</ul>
<a name="getHostname--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHostname</h4>
<pre>private&nbsp;java.lang.String&nbsp;getHostname()</pre>
<div class="block">Retrieves hostname.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The retrieved hostname.</dd>
</dl>
</li>
</ul>
<a name="hashHostname--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>hashHostname</h4>
<pre>private&nbsp;java.lang.String&nbsp;hashHostname()</pre>
<div class="block">Hashes the hostname using SHA-1 algorithm and returns the hashed value.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The SHA-1 hash of the hostname.</dd>
</dl>
</li>
</ul>
<a name="getIpAddress--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIpAddress</h4>
<pre>private&nbsp;java.lang.String&nbsp;getIpAddress()</pre>
<div class="block">Retrieves the IP address of the host. If any error occurs, it returns localhost address (127.0.0.1).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The IP address of the host.</dd>
</dl>
</li>
</ul>
<a name="getMacAddress--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getMacAddress</h4>
<pre>private&nbsp;java.lang.String&nbsp;getMacAddress()</pre>
<div class="block">Retrieves the MAC address of the host. If any error occurs, it returns a default MAC address (00:00:00:00:00:00).</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String The MAC address of the host.</dd>
</dl>
</li>
</ul>
<a name="getHostArch--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getHostArch</h4>
<pre>private&nbsp;java.lang.String&nbsp;getHostArch()</pre>
<div class="block">Returns host's OS architecture. If the OS architecture cannot retrieved the value "Unknown" is returned.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String OS architecture</dd>
</dl>
</li>
</ul>
<a name="initializeAgentJson--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>initializeAgentJson</h4>
<pre>private&nbsp;org.json.JSONObject&nbsp;initializeAgentJson()</pre>
<div class="block">Retrieves some information about the agent, making the conversion. More specific it returns
 a JSON object containing the following inforamtion: Some IDs of the agent (ephemeral_id, id),
 the agent's name (which is the same as hostname), agent's type and version and the hostname.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>JSONObject A JSON object, which contains information about the agent making the conversion
 from input csv record to Elastic JSON record</dd>
</dl>
</li>
</ul>
<a name="encodeTcpFlags-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>encodeTcpFlags</h4>
<pre>private&nbsp;int&nbsp;encodeTcpFlags(java.lang.String&nbsp;flags)</pre>
<div class="block">Encode TCP flags to an integer number, which is created for the sum of each
 flag's representation as an integer number. More specifically they are encoded
 as follows: F-1, S-2, R-4, P-8, A-16, U-32. X, if exists means that all
 other flags exist, so it is encoded as the sum of all, which is equal to 63.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>flags</code> - String A string, which contains all TCP flags.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>int The sum of each existing flag's representation.</dd>
</dl>
</li>
</ul>
<a name="loadMappingFile-boolean-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>loadMappingFile</h4>
<pre>private&nbsp;org.json.JSONObject&nbsp;loadMappingFile(boolean&nbsp;raw)</pre>
<div class="block">Loads a JSON file, that contains some mapping details between the csv column
 name and the category and sub-category of the new Elastic JSON object. If any
 error occurs while loading the mapping file, a default JSON mapping will
 be returned.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>raw</code> - Boolean Declares if the mapping file for raw netflow data must be
            loaded or not.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>JSONObject A JSON object, which contains all mapping details between
 the csv records and the created JSON object.</dd>
</dl>
</li>
</ul>
<a name="getNetflowDirection-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNetflowDirection</h4>
<pre>private&nbsp;java.lang.String&nbsp;getNetflowDirection(java.lang.String&nbsp;srcIp,
                                             java.lang.String&nbsp;dstIp)</pre>
<div class="block">Checks if the given netflow is internal, external, inbound or outbound.
 If it cannot be defined, it returns the label "unknown". This decision
 is based on the source and destination IP of the netflow. A netflow will
 be labeled as internal if both source and destination IPs are internal.
 If both IPs are not internal the netflow will be labeled as external.
 A netflow will be labeled as outbound if source IP is internal and
 destination IP is external. On the other hand, if the destination IP is
 internal and source IP is external, the flow will be labeled as inbound.
 If the netflow direction cannot be defined, or if any other error occurs,
 the netflow will be labeled as unknown. A list with internal IPs will be
 used in order to decide if the IP is internal or external.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>srcIp</code> - String Source IP address.</dd>
<dd><code>dstIp</code> - String Destination IP address.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String A string, that show the netflow direction. It will be one of
 internal, external, inbound, outbound, unknown.</dd>
</dl>
</li>
</ul>
<a name="getNetworkCommunityId-java.lang.String-java.lang.String-int-int-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getNetworkCommunityId</h4>
<pre>private&nbsp;java.lang.String&nbsp;getNetworkCommunityId(java.lang.String&nbsp;srcIp,
                                               java.lang.String&nbsp;dstIp,
                                               int&nbsp;srcPort,
                                               int&nbsp;dstPort,
                                               java.lang.String&nbsp;protocol)</pre>
<div class="block">Creates and returns the network community ID of the netflow. The
 community ID is an identifier for a netflow, which is produced using
 some netflow fields. More specifically it uses source IP address,
 destination IP address, source and destination ports and the netflow
 protocol (UDP, TCP). The flow community ID is generated using the open-source
 community-id-java library (https://github.com/rapid7/community-id-java).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>srcIp</code> - String Source IP address.</dd>
<dd><code>dstIp</code> - String Destination IP address.</dd>
<dd><code>srcPort</code> - Int Source port.</dd>
<dd><code>dstPort</code> - Int Destination port.</dd>
<dd><code>protocol</code> - String Protocol of the netflow (TCP, UDP).</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>String A netflow hash, which follows the open Community ID
 (https://github.com/corelight/community-id-spec) netflow hashing standard.</dd>
</dl>
</li>
</ul>
<a name="loadInternalSubnets--">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>loadInternalSubnets</h4>
<pre>private&nbsp;java.util.ArrayList&lt;java.lang.String&gt;&nbsp;loadInternalSubnets()</pre>
<div class="block">Loads all subnets, that their IPs must be defined as internal IPs. The list
 of these subnets must be written in a txt file, in the following format: IP/Mask.
 (For example: 192.168.2.0/24). All IPs of these subnets will be a loaded in a
 list and used for defining if an IP is internal (belonging in one of these subnets)
 or external. If the file with the subnets cannot be loaded, some default subnets will
 be returned. These default subnets are the following: 10.10.5.0/24, 10.10.11.0/24,
 192.168.1.0/24, 192.168.2.0/24.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>ArrayList(String) A list which contains all IPs that will be marked as internals.</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/ElasticJsonObject.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../deprecated-list.html">Deprecated</a></li>
<li><a href="../index-files/index-1.html">Index</a></li>
<li><a href="../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../utils/CsvRecordSchema.html" title="class in utils"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../utils/Helpers.html" title="class in utils"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../index.html?utils/ElasticJsonObject.html" target="_top">Frames</a></li>
<li><a href="ElasticJsonObject.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field.summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field.detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor.detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
